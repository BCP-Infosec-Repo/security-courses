\documentclass[a4paper,11pt,notitlepage]{report}
% Henrik Lund Kramshoej, February 2001
% hlk@security6.net,
% My standard packages
\usepackage{zencurity-network-exercises}

\begin{document}

\rm
\selectlanguage{english}

\newcommand{\emne}[1]{Computer Systems Security workshop}
\newcommand{\kursus}[1]{Computer Systems Security workshop}
\newcommand{\kursusnavn}[1]{Computer Systems Security workshop\\ exercises}

\mytitle{Computer Systems Security}{exercises}

\pagenumbering{roman}


\setcounter{tocdepth}{0}

\normal

{\color{titlecolor}\tableofcontents}
%\listoffigures - not used
%\listoftables - not used

\normal
\pagestyle{fancyplain}
\chapter*{\color{titlecolor}Preface}
\markboth{Preface}{}

This material is prepared for use in \emph{\kursus} and was prepared by
Henrik Lund Kramshoej, \link{http://www.zencurity.com} .
It describes the networking setup and
applications for trainings and workshops where hands-on exercises are needed.

\vskip 1cm
Further a presentation is used which is available as PDF from kramse@Github\\
Look for \jobname in the repo security-courses.

These exercises are expected to be performed in a training setting with network connected systems. The exercises use a number of tools which can be copied and reused after training. A lot is described about setting up your workstation in the repo

\link{https://github.com/kramse/kramse-labs}



\section*{\color{titlecolor}Prerequisites}

This material expect that participants have a working knowledge of
TCP/IP from a user perspective. Basic concepts such as web site addresses and email should be known as well as IP-addresses and common protocols like DHCP.

\vskip 1cm
Have fun and learn
\eject

% =================== body of the document ===============
% Arabic page numbers
\pagenumbering{arabic}
\rhead{\fancyplain{}{\bf \chaptername\ \thechapter}}

% Main chapters
%---------------------------------------------------------------------
% gennemgang af emnet
% check questions

\chapter*{\color{titlecolor}Exercise content}
\markboth{Exercise content}{}

Most exercises follow the same procedure and has the following content:
\begin{itemize}
\item {\bf Objective:} What is the exercise about, the objective
\item {\bf Purpose:} What is to be the expected outcome and goal of doing this exercise
\item {\bf Suggested method:} suggest a way to get started
\item {\bf Hints:} one or more hints and tips or even description how to
do the actual exercises
\item {\bf Solution:} one possible solution is specified
\item {\bf Discussion:} Further things to note about the exercises, things to remember and discuss
\end{itemize}

Please note that the method and contents are similar to real life scenarios and does not detail every step of doing the exercises. Entering commands directly from a book only teaches typing, while the exercises are designed to help you become able to learn and actually research solutions.


\chapter{Download Kali Linux Revealed (KLR) Book 10 min}
\label{ex:downloadKLR}


\hlkimage{3cm}{kali-linux-revealed.jpg}

\emph{Kali Linux Revealed  Mastering the Penetration Testing Distribution}


{\bf Objective:}\\
We need a Kali Linux for running tools during the course. This is open source, and the developers have released a whole book about running Kali Linux.

This is named Kali Linux Revealed (KLR)

{\bf Purpose:}\\
We need to install Kali Linux in a few moments, so better have the instructions ready.

{\bf Suggested method:}\\
Create folders for educational materials. Go to \link{https://www.kali.org/download-kali-linux-revealed-book/}
Read and follow the instructions for downloading the book.

{\bf Solution:}\\
When you have a directory structure for download for this course, and the book KLR in PDF you are done.

{\bf Discussion:}\\
Linux is free and everywhere. The tools we will run in this course are made for Unix, so they run great on Linux.

Kali Linux is a free pentesting platform, and probably worth more than \$10.000

The book KLR is free, but you can buy/donate, and I recommend it.

\chapter{Check your Kali VM, run Kali Linux 30 min}
\label{ex:basicVM}

\hlkimage{10cm}{kali-linux.png}

{\bf Objective:}\\
Make sure your virtual machine is in working order.

We need a Kali Linux for running tools during the course.

{\bf Purpose:}\\
If your VM is not installed and updated we will run into trouble later.

{\bf Suggested method:}\\
Go to \link{https://github.com/kramse/kramse-labs/}

Read the instructions for the setup of a Kali VM.

{\bf Hints:}\\
If you allocate enough memory and disk you wont have problems.

{\bf Solution:}\\
When you have a updated virtualisation software and Kali Linux, then we are good.

{\bf Discussion:}\\
Linux is free and everywhere. The tools we will run in this course are made for Unix, so they run great on Linux.

Kali Linux includes many hacker tools and should be known by anyone working in infosec.

\chapter{Check your Debian VM 10 min}
\label{ex:basicDebianVM}

\hlkimage{3cm}{debian-9.png}

{\bf Objective:}\\
Make sure your virtual Debian 9 machine is in working order.

We need a Debian 9 Linux for running a few extra tools during the course.

{\Large \bf This is a bonus exercise - only one Debian is needed per team.}

{\bf Purpose:}\\
If your VM is not installed and updated we will run into trouble later.

{\bf Suggested method:}\\
Go to \link{https://github.com/kramse/kramse-labs/}

Read the instructions for the setup of a Kali VM.

{\bf Hints:}\\

{\bf Solution:}\\
When you have a updated virtualisation software and Kali Linux, then we are good.

{\bf Discussion:}\\
Linux is free and everywhere. The tools we will run in this course are made for Unix, so they run great on Linux.



\chapter{Investigate /etc 10 min}
\label{ex:basicLinuxetc}


{\bf Objective:}\\
We will investigate the /etc directory on Linux

We need a Debian 9 Linux and a Kali Linux, to compare


{\bf Purpose:}\\
Start seeing example configuration files, including:
\begin{itemize}
  \item User database \verb+/etc/passwd+ and \verb+/etc/group+
  \item The password database \verb+/etc/shadow+
\end{itemize}

{\bf Suggested method:}\\
Boot your Linux VMs, log in

Investigate permissions for the user database files \verb+passwd+ and \verb+shadow+

{\bf Hints:}\\
Linux has many tools for viewing files, the most efficient would be less.

\begin{alltt}
hlk@debian:~$ cd /etc
hlk@debian:/etc$ ls -l shadow passwd
-rw-r--r-- 1 root root   2203 Mar 26 17:27 passwd
-rw-r----- 1 root shadow 1250 Mar 26 17:27 shadow
hlk@debian:/etc$ ls
... all files and directories shown, investigate more if you like
\end{alltt}

Showing a single file: \verb+less /etc/passwd+ and press q to quit

Showing multiple files: \verb+less /etc/*+ then :n for next and q for quit

\begin{alltt}
Trying reading the shadow file as your regular user:
user@debian-9-lab:/etc$ cat /etc/shadow
cat: /etc/shadow: Permission denied
\end{alltt}

Why is that? Try switching to root, using su or sudo, and redo the command.

{\bf Solution:}\\
When you have seen the most basic files you are done.

{\bf Discussion:}\\
Linux is free and everywhere. The tools we will run in this course are made for Unix, so they run great on Linux.








\chapter{Risk Assessment 101}
\label{ex:risk-assessment-101}

\begin{quote}
In quantitative risk assessment an annualized loss expectancy (ALE) may be used to justify the cost of implementing countermeasures to protect an asset. This may be calculated by multiplying the single loss expectancy (SLE), which is the loss of value based on a single security incident, with the annualized rate of occurrence (ARO), which is an estimate of how often a threat would be successful in exploiting a vulnerability.
\end{quote}

Quote from \link{https://en.wikipedia.org/wiki/Risk\_assessment}

{\bf Objective:}\\
Do calculations to understand risk assessment better

{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\
What we have done here is Quantitative Risk Assessment.

Other risk analysis methods exist, qualitative risk analysis - used when it is difficult to put amount



\chapter{Run Armitage - Hail Mary}
\label{ex:hail-mary}

{\bf Objective:}\\
Try hacking using a graphical program, see how quick and easy it can be.

{\bf Purpose:}\\
Show that when a vulnerability exist attacks can be quick and easy.

{\bf Suggested method:}\\

\begin{enumerate}
\item Boot up Kali Linux
\item Boot up Metasploitable - from ISO
\item Run Armitage Hail-Mary against Metasploitable
\item Note which succeeded, describe those attacks that succeeded in relation to MITRE ATT\&CK framework
\end{enumerate}

{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\





\chapter{SELinux Introduction}
\label{ex:se-linux-intro}

{\bf Objective:}\\
Create a secret file, that you can read, but root cant.

Check out the SELinux system
\link{https://www.debian.org/doc/manuals/debian-handbook/sect.selinux.en.html}

{\bf Purpose:}\\


{\bf Suggested method:}\\
Try enabling and disabling the policies

{\bf Hints:}\\


{\bf Solution:}\\
When you have a small text file which you can read, but root cannot, you are done.

Yes, the root user can disable the SELinux protection :-D

{\bf Discussion:}\\


\chapter{Example AUPs}
\label{ex:example-AUP}

{\bf Objective:}\\
See real world high level policies

{\bf Purpose:}\\


{\bf Suggested method:}\\
Find your AUP for the ISPs we use, you use, your company uses

{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\

\chapter{Database Security}
\label{ex:database-security}

{\bf Objective:}\\


{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\
Databases - discussion about Relational Database Management System RDBMS Model and NoSQL



\chapter{SYN flooding 101}
\label{ex:syn-flood-101}

{\bf Objective:}\\


{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\



\chapter{Medical Security Oolicies}
\label{ex:medical-security-policy}

{\bf Objective:}\\


{\bf Purpose:}\\


{\bf Suggested method:}\\
Find example medical security policies

Fitbit


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\



\chapter{Perform privilege escalation using files}
\label{ex:priv-esc-cron}

{\bf Objective:}\\
Perform a simple privilege escalation attack

{\bf Purpose:}\\


{\bf Suggested method:}\\

\begin{enumerate}
\item Make a non-privileged user
\item make a system directory writable
\item create root cronjob without path
\item Insert a malicious script as one of the commands from the root cron job
\end{enumerate}

{\bf Hints:}\\
A cron job runs scheduled commands. They usually perform cleanup functions, removing old files, doing a backup or similar

{\bf Solution:}\\


{\bf Discussion:}\\
This was chosen as I found a similar vulnerability in a professional product, in 2019


\chapter{Anti-virus and "endpoint security"}
\label{ex:anti-virus-end-point-security}

{\bf Objective:}\\
Discuss when to use Anti-virus and "endpoint security"

{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\



\chapter{SSL/TLS scanners 15 min}
\label{ex:sslscan}

{\bf Objective:}\\
Try the Online Qualys SSLLabs scanner \link{https://www.ssllabs.com/}
Try the command line tool sslscan checking servers - can check both HTTPS and non-HTTPS protocols!

{\bf Purpose:}\\
Learn how to efficiently check TLS settings on remote services.

{\bf Suggested method:}\\
Run the tool against a couple of sites of your choice.

\begin{alltt}\small
root@kali:~# sslscan --ssl2 web.kramse.dk
Version: 1.10.5-static
OpenSSL 1.0.2e-dev xx XXX xxxx

Testing SSL server web.kramse.dk on port 443
...
  SSL Certificate:
Signature Algorithm: sha256WithRSAEncryption
RSA Key Strength:    2048

Subject:  *.kramse.dk
Altnames: DNS:*.kramse.dk, DNS:kramse.dk
Issuer:   AlphaSSL CA - SHA256 - G2
\end{alltt}

Also run it without \verb+--ssl2+ and against SMTPTLS if possible.

{\bf Hints:}\\
Originally sslscan is from \link{http://www.titania.co.uk} but use the version on Kali, install with apt if not installed.

{\bf Solution:}\\
When you can run and understand what the tool does, you are done.

{\bf Discussion:}\\
SSLscan can check your own sites, while Qualys SSLLabs only can test from hostname



\chapter{Nmap Ikescan IPsec}
\label{ex:nmap-ikescan}

{\bf Objective:}\\
Try Nmap and Ikescan

{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\


\chapter{SSH scanners}
\label{ex:nmap-ssh-scanner}

{\bf Objective:}\\

 Try ssh scanners, similar to sslscan and Nmap sshscan

{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\


\chapter{Password Cracking}
\label{ex:pwcrack-101}

{\bf Objective:}\\

Crack your own passwords
{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\




\chapter{Email Security 2019}
\label{ex:email-security}

{\bf Objective:}\\


{\bf Purpose:}\\

DNSSEC, SPF, DMARC - DNS based updates to your email domain security


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\




\chapter{VM escapes}
\label{ex:vm-escape}

{\bf Objective:}\\


{\bf Purpose:}\\
Research VM escapes

{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\





\chapter{Centralized syslog}
\label{ex:centralized-syslog-practical}

{\bf Objective:}\\

Centralized syslogging and example system

{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\


\chapter{File System Forensics}
\label{ex:file-system-forensics}

{\bf Objective:}\\

 Open a file system dump
{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\



\chapter{Clean or rebuild a server}
\label{ex:clean-or-rebuild}

{\bf Objective:}\\


{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\


\chapter{Cloud environments influence on incident response}
\label{ex:cloud-incident-response}

{\bf Objective:}\\


{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\





\chapter{System Security in Practice}
\label{ex:system-security-practice}

{\bf Objective:}\\


{\bf Purpose:}\\


{\bf Suggested method:}\\

\begin{itemize}
\item Work on our model network, each team has a router and an attacker - prevent most of the attacks on the Metasploitable server by firewall configuration
\item Investigate Debian as a server - default settings for Web, we will install a system which requires database and web server configured
\item Configure SSH keys
\end{itemize}

{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\





\chapter{Evaluate our network PCI}
\label{ex:PCI-evaluation}

{\bf Objective:}\\
Evaluate our network, quick gap analysis for becoming PCI compliant

{\bf Purpose:}\\


{\bf Suggested method:}\\


{\bf Hints:}\\


{\bf Solution:}\\


{\bf Discussion:}\\

\end{document}
